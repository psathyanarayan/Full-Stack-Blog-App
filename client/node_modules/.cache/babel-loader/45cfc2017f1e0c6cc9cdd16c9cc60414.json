{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import axios from'axios';import{useContext,useState}from'react';import{Context}from'../../context/Context';import'./write.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Write=function Write(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),desc=_useState4[0],setDesc=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),file=_useState6[0],setFile=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),cat=_useState8[0],setCat=_useState8[1];var _useContext=useContext(Context),user=_useContext.user;var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var newPost,data,filename,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();newPost={username:user.username,title:title,desc:desc,cat:cat};if(!file){_context.next=15;break;}data=new FormData();filename=Date.now()+file.name;data.append(\"name\",filename);data.append(\"file\",file);newPost.photo=filename;_context.prev=8;_context.next=11;return axios.post(\"/upload\",data);case 11:_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](8);case 15:_context.prev=15;_context.next=18;return axios.post(\"/posts\",newPost);case 18:res=_context.sent;window.location.replace(\"/posts/\"+res.data._id);_context.next=24;break;case 22:_context.prev=22;_context.t1=_context[\"catch\"](15);case 24:case\"end\":return _context.stop();}}},_callee,null,[[8,13],[15,22]]);}));return function handleSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"write\",children:[file&&/*#__PURE__*/_jsx(\"img\",{src:URL.createObjectURL(file),className:\"fileImg\",alt:\"\",srcset:\"\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"writeForm\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"writeFromGroup\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"fileInput\",children:/*#__PURE__*/_jsx(\"i\",{className:\"addIcon fas fa-plus\"})}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"fileInput\",style:{display:\"none\"},onChange:function onChange(e){return setFile(e.target.files[0]);}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Title\",className:\"writeInput\",autoFocus:true,onChange:function onChange(e){return setTitle(e.target.value);}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"writeFromGroup\",children:[/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Tell your story...\",type:\"text\",className:\"writeInput writeText\",onChange:function onChange(e){return setDesc(e.target.value);}}),/*#__PURE__*/_jsx(\"textarea\",{placeholder:\"Category\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"writeSubmit\",type:\"submit\",children:\"Publish\"})]})]});};export default Write;","map":{"version":3,"sources":["/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/src/Pages/Write/Write.jsx"],"names":["axios","useContext","useState","Context","Write","title","setTitle","desc","setDesc","file","setFile","cat","setCat","user","handleSubmit","e","preventDefault","newPost","username","data","FormData","filename","Date","now","name","append","photo","post","res","window","location","replace","_id","URL","createObjectURL","display","target","files","value"],"mappings":"2fAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,UAAT,CAAqBC,QAArB,KAAqC,OAArC,CACA,OAASC,OAAT,KAAwB,uBAAxB,CACA,MAAO,aAAP,C,wFAEA,GAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,EAAM,CAChB,cAA0BF,QAAQ,CAAC,EAAD,CAAlC,wCAAOG,KAAP,eAAcC,QAAd,eACA,eAAwBJ,QAAQ,CAAC,EAAD,CAAhC,yCAAOK,IAAP,eAAaC,OAAb,eACA,eAAwBN,QAAQ,CAAC,IAAD,CAAhC,yCAAOO,IAAP,eAAaC,OAAb,eACA,eAAsBR,QAAQ,CAAC,EAAD,CAA9B,yCAAOS,GAAP,eAAYC,MAAZ,eACA,gBAAiBX,UAAU,CAACE,OAAD,CAA3B,CAAQU,IAAR,aAAQA,IAAR,CAEA,GAAMC,CAAAA,YAAY,0FAAG,iBAAOC,CAAP,gJACjBA,CAAC,CAACC,cAAF,GACMC,OAFW,CAED,CACZC,QAAQ,CAAEL,IAAI,CAACK,QADH,CAEZb,KAAK,CAALA,KAFY,CAGZE,IAAI,CAAJA,IAHY,CAIZI,GAAG,CAAHA,GAJY,CAFC,KAQbF,IARa,0BASPU,IATO,CASA,GAAIC,CAAAA,QAAJ,EATA,CAUPC,QAVO,CAUIC,IAAI,CAACC,GAAL,GAAad,IAAI,CAACe,IAVtB,CAWbL,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBJ,QAApB,EACAF,IAAI,CAACM,MAAL,CAAY,MAAZ,CAAoBhB,IAApB,EACAQ,OAAO,CAACS,KAAR,CAAgBL,QAAhB,CAba,uCAeHrB,CAAAA,KAAK,CAAC2B,IAAN,CAAW,SAAX,CAAqBR,IAArB,CAfG,0IAqBKnB,CAAAA,KAAK,CAAC2B,IAAN,CAAW,QAAX,CAAqBV,OAArB,CArBL,SAqBPW,GArBO,eAsBbC,MAAM,CAACC,QAAP,CAAgBC,OAAhB,CAAwB,UAAUH,GAAG,CAACT,IAAJ,CAASa,GAA3C,EAtBa,+JAAH,kBAAZlB,CAAAA,YAAY,4CAAlB,CA4BA,mBACI,aAAK,SAAS,CAAC,OAAf,WACKL,IAAI,eACA,YAAK,GAAG,CAAEwB,GAAG,CAACC,eAAJ,CAAoBzB,IAApB,CAAV,CAAqC,SAAS,CAAC,SAA/C,CAAyD,GAAG,CAAC,EAA7D,CAAgE,MAAM,CAAC,EAAvE,EAFT,cAKI,cAAM,SAAS,CAAC,WAAhB,CAA4B,QAAQ,CAAEK,YAAtC,wBACI,aAAK,SAAS,CAAC,gBAAf,wBACI,cAAO,OAAO,CAAC,WAAf,uBAA2B,UAAG,SAAS,CAAC,qBAAb,EAA3B,EADJ,cAEI,cAAO,IAAI,CAAC,MAAZ,CAAmB,EAAE,CAAC,WAAtB,CAAkC,KAAK,CAAE,CAAEqB,OAAO,CAAE,MAAX,CAAzC,CAA6D,QAAQ,CAAE,kBAAApB,CAAC,QAAEL,CAAAA,OAAO,CAACK,CAAC,CAACqB,MAAF,CAASC,KAAT,CAAe,CAAf,CAAD,CAAT,EAAxE,EAFJ,cAGI,cAAO,IAAI,CAAC,MAAZ,CAAmB,WAAW,CAAC,OAA/B,CAAuC,SAAS,CAAC,YAAjD,CAA8D,SAAS,CAAE,IAAzE,CAA+E,QAAQ,CAAE,kBAAAtB,CAAC,QAAET,CAAAA,QAAQ,CAACS,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAV,EAA1F,EAHJ,GADJ,cAMI,aAAK,SAAS,CAAC,gBAAf,wBACI,iBAAU,WAAW,CAAC,oBAAtB,CAA2C,IAAI,CAAC,MAAhD,CAAuD,SAAS,CAAC,sBAAjE,CAAwF,QAAQ,CAAE,kBAAAvB,CAAC,QAAEP,CAAAA,OAAO,CAACO,CAAC,CAACqB,MAAF,CAASE,KAAV,CAAT,EAAnG,EADJ,cAEI,iBAAU,WAAW,CAAC,UAAtB,EAFJ,GANJ,cAWI,eAAQ,SAAS,CAAC,aAAlB,CAAgC,IAAI,CAAC,QAArC,qBAXJ,GALJ,GADJ,CAqBH,CAxDD,CA0DA,cAAelC,CAAAA,KAAf","sourcesContent":["import axios from 'axios';\nimport { useContext, useState } from 'react';\nimport { Context } from '../../context/Context';\nimport './write.css';\n\nconst Write = () => {\n    const [title, setTitle] = useState(\"\");\n    const [desc, setDesc] = useState(\"\");\n    const [file, setFile] = useState(null);\n    const [cat, setCat] = useState([]);\n    const { user } = useContext(Context);\n    \n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        const newPost = {\n            username: user.username,\n            title,\n            desc,\n            cat\n        };\n        if (file) {\n            const data = new FormData();\n            const filename = Date.now() + file.name;\n            data.append(\"name\", filename);\n            data.append(\"file\", file);\n            newPost.photo = filename;\n            try {\n                await axios.post(\"/upload\",data)\n            } catch (err) {\n                \n            }\n        }\n        try {\n            const res = await axios.post(\"/posts\", newPost);\n            window.location.replace(\"/posts/\"+res.data._id )\n        \n        } catch (error) {\n            \n        }\n    }\n    return (\n        <div className=\"write\">\n            {file && (\n                 <img src={URL.createObjectURL(file)} className=\"fileImg\" alt=\"\" srcset=\"\" />\n            )}\n           \n            <form className=\"writeForm\" onSubmit={handleSubmit}>\n                <div className=\"writeFromGroup\">\n                    <label htmlFor=\"fileInput\"><i className=\"addIcon fas fa-plus\"></i></label>\n                    <input type=\"file\" id=\"fileInput\" style={{ display: \"none\"}} onChange={e=>setFile(e.target.files[0])} />\n                    <input type=\"text\" placeholder=\"Title\" className=\"writeInput\" autoFocus={true} onChange={e=>setTitle(e.target.value)} />\n                </div>\n                <div className=\"writeFromGroup\">\n                    <textarea placeholder=\"Tell your story...\" type=\"text\" className=\"writeInput writeText\" onChange={e=>setDesc(e.target.value)}></textarea>\n                    <textarea placeholder=\"Category\" ></textarea>\n                    </div>\n                   \n                <button className=\"writeSubmit\" type=\"submit\">Publish</button>\n            </form>\n        </div>\n    );\n}\n\nexport default Write;\n"]},"metadata":{},"sourceType":"module"}