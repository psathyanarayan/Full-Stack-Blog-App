{"ast":null,"code":"import _regeneratorRuntime from\"/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./singlepst.css';import{useLocation}from'react-router';import{useContext,useEffect,useState}from'react';import{Link}from\"react-router-dom\";import axios from'axios';import Markdown from'markdown-to-jsx';import{Context}from'../../context/Context';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SinglePst=function SinglePst(){var location=useLocation();var path=location.pathname.split(\"/\")[2];var _useState=useState({}),_useState2=_slicedToArray(_useState,2),post=_useState2[0],setPost=_useState2[1];var PF=\"https://sathyanarayan.herokuapp.com/images/\";var _useContext=useContext(Context),user=_useContext.user;var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),title=_useState4[0],setTitle=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),desc=_useState6[0],setDesc=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),updateMode=_useState8[0],setUpdateMode=_useState8[1];useEffect(function(){var getPost=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/posts/\"+path);case 2:res=_context.sent;setPost(res.data);setTitle(res.data.title);setDesc(res.data.desc);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getPost(){return _ref.apply(this,arguments);};}();getPost();},[path]);var handleDelete=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.delete(\"/posts/\".concat(post._id),{data:{username:user.username}});case 3:window.location.replace(\"/\");_context2.next=8;break;case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);case 8:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleUpdate=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;_context3.next=3;return axios.put(\"/posts/\".concat(post._id),{username:user.username,title:title,desc:desc});case 3:window.location.reload();setUpdateMode(false);_context3.next=9;break;case 7:_context3.prev=7;_context3.t0=_context3[\"catch\"](0);case 9:case\"end\":return _context3.stop();}}},_callee3,null,[[0,7]]);}));return function handleUpdate(){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"singlepost\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostWrapper\",children:[post.photo&&/*#__PURE__*/_jsx(\"img\",{src:PF+post.photo,alt:\"\",className:\"wrapperImg\"}),updateMode?/*#__PURE__*/_jsx(\"input\",{type:\"text\",autoFocus:true,value:title,className:\"singlePostTitleInput\",onChange:function onChange(e){setTitle(e.target.value);}}):/*#__PURE__*/_jsxs(\"h1\",{className:\"singlePostTitle\",children:[post.title,post.username===(user===null||user===void 0?void 0:user.username)&&/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostEdit\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-edit\",onClick:function onClick(){return setUpdateMode(true);}},\"item1\"),/*#__PURE__*/_jsx(\"i\",{className:\"singlePostIcon far fa-trash-alt\",onClick:handleDelete},\"item2\")]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"singlePostInfo\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"singlePostAuthor\",children:[\"Author: \",/*#__PURE__*/_jsx(Link,{to:\"/?user=\".concat(post.username),className:\" mobAuth link\",children:/*#__PURE__*/_jsx(\"b\",{children:post.username})}),\" \"]}),/*#__PURE__*/_jsx(\"span\",{className:\"singlePostDate\",children:new Date(post.createdAt).toDateString()})]}),updateMode?/*#__PURE__*/_jsx(\"textarea\",{className:\"singlePostDescInput\",value:desc,onChange:function onChange(e){return setDesc(e.target.value);}}):/*#__PURE__*/_jsx(\"p\",{className:\"singlePostDesc\",children:/*#__PURE__*/_jsx(Markdown,{options:{forceBlock:true},children:desc})}),updateMode&&/*#__PURE__*/_jsx(\"button\",{className:\"singlePostButton\",onClick:handleUpdate,children:\"Update\"})]})});};export default SinglePst;","map":{"version":3,"sources":["/Users/sathyanarayan/ReactWorks/Blog/my-blog/client/src/components/SinglePost/SinglePst.jsx"],"names":["useLocation","useContext","useEffect","useState","Link","axios","Markdown","Context","SinglePst","location","path","pathname","split","post","setPost","PF","user","title","setTitle","desc","setDesc","updateMode","setUpdateMode","getPost","get","res","data","handleDelete","delete","_id","username","window","replace","handleUpdate","put","reload","photo","e","target","value","Date","createdAt","toDateString","forceBlock"],"mappings":"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","sourcesContent":["import './singlepst.css';\nimport { useLocation } from 'react-router';\nimport { useContext, useEffect, useState } from 'react';\nimport { Link } from \"react-router-dom\";\nimport axios from 'axios';\nimport Markdown from 'markdown-to-jsx';\nimport { Context } from '../../context/Context';\nconst SinglePst = () => {\n    const location = useLocation();\n    const path = location.pathname.split(\"/\")[2];\n    const [post, setPost] = useState({})\n    const PF = \"https://sathyanarayan.herokuapp.com/images/\"\n    const { user } = useContext(Context);\n    const [title, setTitle] = useState(\"\");\n    const [desc, setDesc] = useState(\"\");\n    const [updateMode, setUpdateMode] = useState(false);\n\n    useEffect(() => {\n        const getPost = async () => {\n            const res = await axios.get(\"/posts/\" + path);\n            setPost(res.data);\n            setTitle(res.data.title);\n            setDesc(res.data.desc);\n        }\n        getPost();\n    }, [path]);\n\n    const handleDelete = async () => {\n        try {\n            await axios.delete(`/posts/${post._id}`, {\n                data: { username: user.username },\n            });\n            window.location.replace(\"/\");\n        } catch (err) { }\n    };\n\n    const handleUpdate = async () => {\n        try {\n            await axios.put(`/posts/${post._id}`, {\n                username: user.username,\n                title,\n                desc,\n            });\n            window.location.reload();\n            setUpdateMode(false)\n        } catch (err) { }\n    };\n\n\n\n    return (\n        <div className=\"singlepost\">\n            <div className=\"singlePostWrapper\">\n                {post.photo && (\n                    <img src={PF + post.photo} alt=\"\" className=\"wrapperImg\" />\n\n                )}\n\n                {\n                    updateMode ? <input type=\"text\" autoFocus value={title} className=\"singlePostTitleInput\" onChange={(e) => { setTitle(e.target.value) }} /> : (\n                        <h1 className=\"singlePostTitle\">{post.title}\n                            {post.username === user?.username && (\n                                <div className=\"singlePostEdit\">\n                                    <i className=\"singlePostIcon far fa-edit\" key=\"item1\" onClick={() => setUpdateMode(true)}></i>\n                                    <i className=\"singlePostIcon far fa-trash-alt\" key=\"item2\" onClick={handleDelete}></i>\n                                </div>\n                            )}\n                        </h1>\n                    )}\n\n\n\n                <div className=\"singlePostInfo\">\n                    <span className=\"singlePostAuthor\">Author: <Link to={`/?user=${post.username}`} className=\" mobAuth link\"><b>{post.username}</b></Link> </span>\n                    <span className=\"singlePostDate\">{new Date(post.createdAt).toDateString()}</span>\n                </div>\n                {updateMode ? (\n                    <textarea\n                        className=\"singlePostDescInput\"\n                        value={desc}\n                        onChange={(e) => setDesc(e.target.value)}\n                    />\n                ) : (\n                    <p className=\"singlePostDesc\"><Markdown options={{ forceBlock: true }}>{desc}</Markdown></p>\n                )}\n                {updateMode && (\n                    <button className=\"singlePostButton\" onClick={handleUpdate}>\n                        Update\n                    </button>\n                )}\n            </div>\n\n\n        </div>\n\n    );\n}\n\nexport default SinglePst;\n"]},"metadata":{},"sourceType":"module"}